<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Auth State - TaskApp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: white;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 600px;
            width: 100%;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }
        .section h2 {
            color: #667eea;
            font-size: 18px;
            margin-bottom: 15px;
        }
        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #0d47a1;
            word-break: break-all;
        }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        .status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .status.logged-in {
            background: #d4edda;
            color: #155724;
        }
        .status.logged-out {
            background: #f8d7da;
            color: #721c24;
        }
        .empty {
            color: #999;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Debug Auth State</h1>
        <p class="subtitle">Ki·ªÉm tra v√† x√≥a Firebase authentication session</p>

        <div class="section">
            <h2>üìä Tr·∫°ng th√°i hi·ªán t·∫°i</h2>
            <div id="status"></div>
        </div>

        <div class="section">
            <h2>üíæ LocalStorage Data</h2>
            <div id="localStorage"></div>
        </div>

        <div class="section">
            <h2>üîë SessionStorage Data</h2>
            <div id="sessionStorage"></div>
        </div>

        <div class="section">
            <h2>‚öôÔ∏è Actions</h2>
            <button class="btn btn-danger" onclick="clearAll()">üóëÔ∏è X√≥a t·∫•t c·∫£ session</button>
            <button class="btn" onclick="refreshPage()">üîÑ Refresh trang</button>
            <button class="btn btn-success" onclick="goToApp()">üöÄ Quay l·∫°i ·ª©ng d·ª•ng</button>
        </div>
    </div>

    <script>
        function displayStatus() {
            const localKeys = Object.keys(localStorage);
            const sessionKeys = Object.keys(sessionStorage);
            const hasFirebaseData = localKeys.some(key => key.includes('firebase')) || 
                                   sessionKeys.some(key => key.includes('firebase'));

            const statusDiv = document.getElementById('status');
            if (hasFirebaseData) {
                statusDiv.innerHTML = `
                    <span class="status logged-in">‚úÖ C√≥ Firebase session</span>
                    <p style="margin-top: 10px; color: #666;">
                        B·∫°n c√≥ Firebase authentication data trong tr√¨nh duy·ªát. 
                        ƒêi·ªÅu n√†y c√≥ th·ªÉ khi·∫øn b·∫°n t·ª± ƒë·ªông ƒëƒÉng nh·∫≠p khi truy c·∫≠p ·ª©ng d·ª•ng.
                    </p>
                `;
            } else {
                statusDiv.innerHTML = `
                    <span class="status logged-out">‚ùå Kh√¥ng c√≥ session</span>
                    <p style="margin-top: 10px; color: #666;">
                        Kh√¥ng t√¨m th·∫•y Firebase session. B·∫°n s·∫Ω ƒë∆∞·ª£c y√™u c·∫ßu ƒëƒÉng nh·∫≠p khi truy c·∫≠p ·ª©ng d·ª•ng.
                    </p>
                `;
            }
        }

        function displayStorage(storageType, elementId) {
            const storage = storageType === 'local' ? localStorage : sessionStorage;
            const div = document.getElementById(elementId);
            const keys = Object.keys(storage);

            if (keys.length === 0) {
                div.innerHTML = '<p class="empty">Tr·ªëng</p>';
                return;
            }

            let html = '';
            keys.forEach(key => {
                const value = storage.getItem(key);
                const displayValue = value.length > 100 ? value.substring(0, 100) + '...' : value;
                html += `<div class="info"><strong>${key}:</strong><br>${displayValue}</div>`;
            });
            div.innerHTML = html;
        }

        function clearAll() {
            if (confirm('‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ session data?\n\nƒêi·ªÅu n√†y s·∫Ω ƒëƒÉng xu·∫•t b·∫°n kh·ªèi ·ª©ng d·ª•ng.')) {
                localStorage.clear();
                sessionStorage.clear();
                alert('‚úÖ ƒê√£ x√≥a t·∫•t c·∫£ session data!');
                location.reload();
            }
        }

        function refreshPage() {
            location.reload();
        }

        function goToApp() {
            window.location.href = '/';
        }

        // Initialize
        displayStatus();
        displayStorage('local', 'localStorage');
        displayStorage('session', 'sessionStorage');
    </script>
</body>
</html>
